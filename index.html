<html lang="en">

<head>
    <link type="text/css" rel="stylesheet" href="css/materialize.min.css" media="screen,projection" />
    <link type="text/css" rel="stylesheet" href="css/materialize_style_colors.css" media="screen,projection" />
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet">
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Gag Wheel Calculator</title>
</head>

<body class="grey darken-3">
    <div class="row">
        <form class="col s12">
            <div class="row">
                <div class="input-field col s12">
                    <input id="donation_amount_uid" type="number" class="white-text validate" />
                    <label class="white-text" for="donation_amount_uid">Donation</label>
                </div>
            </div>
            <div class="row">
                <div class="col s12">
                    <p>
                        <label>
                            <input id="midas_uid" type="checkbox" class="filled-in checkbox-blue-grey" />
                            <span class="white-text">Hand of Midas</span>
                        </label>
                    </p>
                </div>
            </div>
            <div class="row">
                <div class="col s12">
                    <a id="check_button_uid" class="waves-effect waves-light btn green darken-2">Check</a>
                </div>
            </div>
            <div class="row">
                <div class="col s12">
                    <input disabled id="wheels_count_uid" type="text" class="white-text">
                    <label class="white-text" for="wheels_count_uid">Wheel's count</label>
                </div>
            </div>
            <div class="row">
                <div class="col s12">
                    <input disabled id="donation_change_uid" type="text" class="white-text">
                    <label class="white-text" for="donation_change_uid">Donation change</label>
                </div>
            </div>
            <div class="row">
                <div class="col s12">
                    <input disabled id="next_wheel_price_uid" type="text" class="white-text">
                    <label class="white-text" for="next_wheel_price_uid">Next wheel price</label>
                </div>
            </div>
        </form>
    </div>

    <script type="text/javascript" src="js/materialize.min.js"></script>
    <script type="text/javascript" src="js/jquery-3.7.1.min.js"></script>

    <script>
        const DONATION_WHEEL_START_PRICE = 500
        const DONATION_WHEEL_MIDAS_HAND_PRICE = 1500

        class DonationWheelsData {
            constructor(wheelsCount, donationChange, nextWheelPrice) {
                this.wheelsCount = wheelsCount
                this.donationChange = donationChange
                this.nextWheelPrice = nextWheelPrice
            }
        }

        document.getElementById("check_button_uid").addEventListener("click", function () {
            let donationAmount = document.getElementById("donation_amount_uid").value
            let donationData = calculateWheelsCount(donationAmount)

            document.getElementById("wheels_count_uid").value = donationData.wheelsCount
            document.getElementById("donation_change_uid").value = donationData.donationChange
            document.getElementById("next_wheel_price_uid").value = donationData.nextWheelPrice
        });

        function calculateWheelsCount(inDonationAmount) {
            let donationLeft = inDonationAmount
            let wheelPrice = DONATION_WHEEL_START_PRICE
            let wheelsCount = 0

            while (donationLeft >= wheelPrice) {
                wheelsCount++
                donationLeft -= wheelPrice
                wheelPrice += DONATION_WHEEL_START_PRICE
            }

            return new DonationWheelsData(wheelsCount, donationLeft, wheelPrice)
        }

        function isMidasActive() {
            return document.getElementById("midas_uid").checked
        }

    </script>

</body>

</html>